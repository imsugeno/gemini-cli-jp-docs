# 複数ファイル読み取りツール (`read_many_files`)

このドキュメントでは、Gemini CLI の `read_many_files` ツールについて説明します。

## 説明

`read_many_files` を使用して、パスまたは glob パターンで指定された複数のファイルからコンテンツを読み取ります。このツールの動作は、指定されたファイルによって異なります。

- テキストファイルの場合、このツールはそれらのコンテンツを単一の文字列に連結します。
- 画像 (PNG、JPEG など) および PDF ファイルの場合、名前または拡張子で明示的に要求された場合に、base64 エンコードデータとして読み取って返します。

`read_many_files` は、コードベースの概要の取得、特定の機能が実装されている場所の検索、ドキュメントの確認、複数の設定ファイルからのコンテキストの収集などのタスクを実行するために使用できます。

### 引数

`read_many_files` は次の引数を取ります。

- `paths` (文字列のリスト、必須): ツールのターゲットディレクトリからの相対パスまたは glob パターンの配列 (例: `["src/**/*.ts"]`、`["README.md", "docs/", "assets/logo.png"]`)。
- `exclude` (文字列のリスト、任意): 除外するファイル/ディレクトリの glob パターン (例: `["**/*.log", "temp/"]`)。`useDefaultExcludes` が true の場合、これらはデフォルトの除外に追加されます。
- `include` (文字列のリスト、任意): 含める追加の glob パターン。これらは `paths` とマージされます (例: `["*.test.ts"]` は、広範囲に除外されていた場合にテストファイルを具体的に追加するため、または `["images/*.jpg"]` は、特定の画像タイプを含めるため)。
- `recursive` (ブール値、任意): 再帰的に検索するかどうか。これは主に glob パターンの `**` によって制御されます。デフォルトは `true` です。
- `useDefaultExcludes` (ブール値、任意): デフォルトの除外パターン (例: `node_modules`、`.git`、画像/PDF 以外のバイナリファイル) のリストを適用するかどうか。デフォルトは `true` です。
- `respect_git_ignore` (ブール値、任意): ファイルを検索するときに .gitignore パターンを尊重するかどうか。デフォルトは true です。

## Gemini CLI で `read_many_files` を使用する方法

`read_many_files` は、指定された `paths` および `include` パターンに一致するファイルを検索し、`exclude` パターンとデフォルトの除外 (有効な場合) を尊重します。

- テキストファイルの場合: 一致した各ファイルのコンテンツを読み取り (画像/PDF として明示的に要求されていないバイナリファイルはスキップしようとします)、各ファイルのコンテンツの間に区切り文字 `--- {filePath} ---` を付けて単一の文字列に連結します。デフォルトでは UTF-8 エンコーディングを使用します。
- 画像および PDF ファイルの場合: 名前または拡張子で明示的に要求された場合 (例: `paths: ["logo.png"]` または `include: ["*.pdf"]`)、ツールはファイルを読み取り、そのコンテンツを base64 エンコードされた文字列として返します。
- ツールは、初期コンテンツにヌルバイトがあるかどうかを確認することで、他のバイナリファイル (一般的な画像/PDF タイプに一致しない、または明示的に要求されていないもの) を検出し、スキップしようとします。

使用法:

```
read_many_files(paths=["ここにファイルまたはパスを入力"], include=["含める追加ファイル"], exclude=["除外するファイル"], recursive=False, useDefaultExcludes=false, respect_git_ignore=true)
```

## `read_many_files` の例

`src` ディレクトリ内のすべての TypeScript ファイルを読み取ります。

```
read_many_files(paths=["src/**/*.ts"])
```

メインの README、`docs` ディレクトリ内のすべての Markdown ファイル、および特定のロゴ画像を読み取りますが、特定のファイルは除外します。

```
read_many_files(paths=["README.md", "docs/**/*.md", "assets/logo.png"], exclude=["docs/OLD_README.md"])
```

すべての JavaScript ファイルを読み取りますが、テストファイルと `images` フォルダ内のすべての JPEG を明示的に含めます。

```
read_many_files(paths=["**/*.js"], include=["**/*.test.js", "images/**/*.jpg"], useDefaultExcludes=False)
```

## 重要な注意事項

- **バイナリファイルの処理:**
  - **画像/PDF ファイル:** ツールは一般的な画像タイプ (PNG、JPEG など) と PDF ファイルを読み取り、base64 エンコードデータとして返すことができます。これらのファイルは、`paths` または `include` パターンによって明示的にターゲットにされる必要があります (例: `image.png` のような正確なファイル名を指定するか、`*.jpeg` のようなパターンを指定する)。
  - **その他のバイナリファイル:** ツールは、初期コンテンツにヌルバイトがあるかどうかを調べることで、他の種類のバイナリファイルを検出し、スキップしようとします。ツールはこれらのファイルを出力から除外します。
- **パフォーマンス:** 非常に多数のファイルまたは非常に大きな個々のファイルを読み取ると、リソースを大量に消費する可能性があります。
- **パスの具体性:** パスと glob パターンがツールのターゲットディレクトリに対して正しく指定されていることを確認してください。画像/PDF ファイルの場合は、パターンがそれらを含めるのに十分具体的であることを確認してください。
- **デフォルトの除外:** デフォルトの除外パターン (`node_modules`、`.git` など) に注意し、それらを上書きする必要がある場合は `useDefaultExcludes=False` を使用しますが、慎重に行ってください。