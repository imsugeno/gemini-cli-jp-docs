# シェルツール (`run_shell_command`)

このドキュメントでは、Gemini CLI の `run_shell_command` ツールについて説明します。

## 説明

`run_shell_command` を使用して、基盤となるシステムと対話し、スクリプトを実行し、またはコマンドライン操作を実行します。`run_shell_command` は、指定されたシェルコマンドを実行します。Windows では、コマンドは `cmd.exe /c` で実行されます。他のプラットフォームでは、コマンドは `bash -c` で実行されます。

### 引数

`run_shell_command` は次の引数を取ります。

- `command` (文字列、必須): 実行する正確なシェルコマンド。
- `description` (文字列、任意): ユーザーに表示されるコマンドの目的の簡単な説明。
- `directory` (文字列、任意): コマンドを実行するディレクトリ (プロジェクトルートからの相対パス)。指定しない場合、コマンドはプロジェクトルートで実行されます。

## Gemini CLI で `run_shell_command` を使用する方法

`run_shell_command` を使用すると、コマンドはサブプロセスとして実行されます。`run_shell_command` は `&` を使用してバックグラウンドプロセスを開始できます。このツールは、次のような実行に関する詳細情報を返します。

- `Command`: 実行されたコマンド。
- `Directory`: コマンドが実行されたディレクトリ。
- `Stdout`: 標準出力ストリームからの出力。
- `Stderr`: 標準エラーストリームからの出力。
- `Error`: サブプロセスによって報告されたエラーメッセージ。
- `Exit Code`: コマンドの終了コード。
- `Signal`: コマンドがシグナルによって終了した場合のシグナル番号。
- `Background PIDs`: 開始されたバックグラウンドプロセスの PID のリスト。

使用法:

```
run_shell_command(command="コマンド", description="コマンドの説明", directory="実行ディレクトリ")
```

## `run_shell_command` の例

現在のディレクトリのファイルを一覧表示します。

```
run_shell_command(command="ls -la")
```

特定のディレクトリでスクリプトを実行します。

```
run_shell_command(command="./my_script.sh", directory="scripts", description="カスタムスクリプトを実行")
```

バックグラウンドサーバーを起動します。

```
run_shell_command(command="npm run dev &", description="バックグラウンドで開発サーバーを起動")
```

## 重要な注意事項

- **セキュリティ:** コマンド、特にユーザー入力から構築されたコマンドを実行するときは、セキュリティの脆弱性を防ぐために注意してください。
- **対話型コマンド:** 対話型のユーザー入力が必要なコマンドは、ツールがハングする可能性があるため避けてください。利用可能な場合は、非対話型フラグ (例: `npm init -y`) を使用してください。
- **エラー処理:** `Stderr`、`Error`、および `Exit Code` フィールドをチェックして、コマンドが正常に実行されたかどうかを判断します。
- **バックグラウンドプロセス:** コマンドが `&` を付けてバックグラウンドで実行されると、ツールはすぐに戻り、プロセスはバックグラウンドで実行され続けます。`Background PIDs` フィールドには、バックグラウンドプロセスのプロセス ID が含まれます。